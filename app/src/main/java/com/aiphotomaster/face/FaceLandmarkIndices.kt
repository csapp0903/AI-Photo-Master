package com.aiphotomaster.face

/**
 * MediaPipe Face Mesh 关键点索引常量
 *
 * MediaPipe Face Mesh 总共检测 468 个面部关键点
 * 此文件定义了用于面部变形的关键区域索引
 */
object FaceLandmarkIndices {

    // ==================== 面部轮廓 ====================
    /**
     * 面部轮廓点（从右太阳穴顺时针到左太阳穴）
     * 用于确定面部边界
     */
    val FACE_OVAL = intArrayOf(
        10, 338, 297, 332, 284, 251, 389, 356, 454, 323, 361, 288,
        397, 365, 379, 378, 400, 377, 152, 148, 176, 149, 150, 136,
        172, 58, 132, 93, 234, 127, 162, 21, 54, 103, 67, 109
    )

    // ==================== 左脸颊区域 ====================
    /**
     * 左脸颊关键点（用于瘦脸）
     */
    val LEFT_CHEEK = intArrayOf(
        36, 47, 50, 101, 116, 117, 118, 119, 123, 135, 137, 138,
        139, 140, 147, 187, 192, 205, 206, 207, 212, 213, 214, 216
    )

    /**
     * 左脸颊中心点索引
     */
    const val LEFT_CHEEK_CENTER = 116

    // ==================== 右脸颊区域 ====================
    /**
     * 右脸颊关键点（用于瘦脸）
     */
    val RIGHT_CHEEK = intArrayOf(
        266, 277, 280, 330, 345, 346, 347, 348, 352, 364, 366, 367,
        368, 369, 376, 411, 416, 425, 426, 427, 432, 433, 434, 436
    )

    /**
     * 右脸颊中心点索引
     */
    const val RIGHT_CHEEK_CENTER = 345

    // ==================== 左眼区域 ====================
    /**
     * 左眼轮廓点
     */
    val LEFT_EYE = intArrayOf(
        33, 7, 163, 144, 145, 153, 154, 155, 133, 173, 157, 158, 159, 160, 161, 246
    )

    /**
     * 左眼中心点索引
     */
    const val LEFT_EYE_CENTER = 468  // 实际使用虹膜中心

    /**
     * 左虹膜点（用于大眼效果）
     */
    val LEFT_IRIS = intArrayOf(468, 469, 470, 471, 472)

    /**
     * 左眼周围扩展区域（用于大眼变形）
     */
    val LEFT_EYE_REGION = intArrayOf(
        33, 7, 163, 144, 145, 153, 154, 155, 133, 173, 157, 158, 159, 160, 161, 246,
        // 眼眶周围
        130, 247, 30, 29, 27, 28, 56, 190, 243, 112, 26, 22, 23, 24, 110, 25
    )

    // ==================== 右眼区域 ====================
    /**
     * 右眼轮廓点
     */
    val RIGHT_EYE = intArrayOf(
        362, 382, 381, 380, 374, 373, 390, 249, 263, 466, 388, 387, 386, 385, 384, 398
    )

    /**
     * 右眼中心点索引
     */
    const val RIGHT_EYE_CENTER = 473  // 实际使用虹膜中心

    /**
     * 右虹膜点
     */
    val RIGHT_IRIS = intArrayOf(473, 474, 475, 476, 477)

    /**
     * 右眼周围扩展区域
     */
    val RIGHT_EYE_REGION = intArrayOf(
        362, 382, 381, 380, 374, 373, 390, 249, 263, 466, 388, 387, 386, 385, 384, 398,
        // 眼眶周围
        359, 467, 260, 259, 257, 258, 286, 414, 463, 341, 256, 252, 253, 254, 339, 255
    )

    // ==================== 鼻子 ====================
    /**
     * 鼻梁中心线
     */
    val NOSE_BRIDGE = intArrayOf(168, 6, 197, 195, 5)

    /**
     * 鼻尖
     */
    const val NOSE_TIP = 1

    // ==================== 嘴唇 ====================
    /**
     * 上嘴唇
     */
    val UPPER_LIP = intArrayOf(
        61, 185, 40, 39, 37, 0, 267, 269, 270, 409, 291,
        308, 415, 310, 311, 312, 13, 82, 81, 80, 191, 78
    )

    /**
     * 下嘴唇
     */
    val LOWER_LIP = intArrayOf(
        61, 146, 91, 181, 84, 17, 314, 405, 321, 375, 291,
        308, 324, 318, 402, 317, 14, 87, 178, 88, 95, 78
    )

    // ==================== 面部中心参考点 ====================
    /**
     * 面部中心点（鼻根）
     */
    const val FACE_CENTER = 168

    /**
     * 下巴中心
     */
    const val CHIN_CENTER = 152

    // ==================== 瘦脸变形控制点 ====================
    /**
     * 左脸颊瘦脸锚点（变形推动方向的起点）
     */
    const val LEFT_CHEEK_ANCHOR = 234

    /**
     * 右脸颊瘦脸锚点
     */
    const val RIGHT_CHEEK_ANCHOR = 454

    /**
     * 瘦脸影响半径内的点（左侧）
     */
    val LEFT_SLIM_REGION = intArrayOf(
        234, 93, 132, 58, 172, 136, 150, 149, 176, 148,
        127, 162, 21, 54, 103, 67, 109, 10,
        // 内部填充点
        36, 47, 50, 101, 116, 117, 118, 119, 123, 135,
        137, 138, 139, 140, 147, 187, 192, 205, 206, 207
    )

    /**
     * 瘦脸影响半径内的点（右侧）
     */
    val RIGHT_SLIM_REGION = intArrayOf(
        454, 323, 361, 288, 397, 365, 379, 378, 400, 377,
        356, 389, 251, 284, 332, 297, 338, 10,
        // 内部填充点
        266, 277, 280, 330, 345, 346, 347, 348, 352, 364,
        366, 367, 368, 369, 376, 411, 416, 425, 426, 427
    )

    // ==================== 辅助方法 ====================

    /**
     * 获取所有需要传递给着色器的关键点索引
     * 为了优化性能，只传递变形相关的点
     */
    fun getWarpingIndices(): IntArray {
        return (LEFT_SLIM_REGION.toList() +
                RIGHT_SLIM_REGION.toList() +
                LEFT_EYE_REGION.toList() +
                RIGHT_EYE_REGION.toList() +
                listOf(FACE_CENTER, LEFT_CHEEK_CENTER, RIGHT_CHEEK_CENTER)).distinct().toIntArray()
    }

    /**
     * 获取面部变形需要的最大关键点数量
     */
    const val MAX_LANDMARKS_FOR_WARP = 128
}
